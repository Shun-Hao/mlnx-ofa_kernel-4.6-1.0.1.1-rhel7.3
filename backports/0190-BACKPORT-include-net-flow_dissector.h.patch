From: Talat Batheesh <talatb@mellanox.com>
Subject: [PATCH] BACKPORT: include/net/flow_dissector.h

Change-Id: I6d1b5ea245ca7b6d3f977df515d3f29440817fbc
---
 include/net/flow_dissector.h | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/include/net/flow_dissector.h b/include/net/flow_dissector.h
index xxxxxxx..xxxxxxx 100644
--- a/include/net/flow_dissector.h
+++ b/include/net/flow_dissector.h
@@ -88,6 +88,7 @@
 #define flow_keys_have_l4 LINUX_BACKPORT(flow_keys_have_l4)
 #define flow_hash_from_keys LINUX_BACKPORT(flow_hash_from_keys)
 #define dissector_uses_key LINUX_BACKPORT(dissector_uses_key)
+#ifndef HAVE_SKB_FLOW_DISSECT
 #define skb_flow_dissector_target LINUX_BACKPORT(skb_flow_dissector_target)
 #define skb_flow_dissect_flow_keys LINUX_BACKPORT(skb_flow_dissect_flow_keys)
 #define __skb_flow_dissect LINUX_BACKPORT(__skb_flow_dissect)
@@ -103,7 +104,7 @@
 #define __get_hash_from_flowi6 LINUX_BACKPORT(__get_hash_from_flowi6)
 #define __get_hash_from_flowi4 LINUX_BACKPORT(__get_hash_from_flowi4)
 #define skb_get_hash_perturb LINUX_BACKPORT(skb_get_hash_perturb)
-
+#endif
 /**
  * struct flow_dissector_key_control:
  * @thoff: Transport header offset
@@ -376,7 +377,7 @@ static inline bool dissector_uses_key(const struct flow_dissector *flow_dissecto
 {
 	return flow_dissector->used_keys & (1 << key_id);
 }
-
+#ifndef HAVE_SKB_FLOW_DISSECT
 static inline void *skb_flow_dissector_target(struct flow_dissector *flow_dissector,
 					      enum flow_dissector_key_id key_id,
 					      void *target_container)
@@ -406,7 +407,7 @@ static inline bool skb_flow_dissect(const struct sk_buff *skb,
 void skb_flow_dissector_init(struct flow_dissector *flow_dissector,
 			     const struct flow_dissector_key *key,
 			     unsigned int key_count);
-
+#endif
 int init_default_flow_dissectors(void);
 
 #endif
